#!/usr/bin/env bash
# OpenShift DPF Environment Defaults
# -----------------------------------
# Source this file to set default values for all configuration variables.
# Variables already set in the environment will NOT be overridden.
# Syntax: ${VAR:-default} means "use default if VAR is unset or empty"

# Cluster Configuration
OPENSHIFT_VERSION=${OPENSHIFT_VERSION:-4.20.4}
USE_V419_WORKAROUND=${USE_V419_WORKAROUND:-false}

# Bridge Configuration
BRIDGE_NAME=${BRIDGE_NAME:-mgmt-br}
SKIP_BRIDGE_CONFIG=${SKIP_BRIDGE_CONFIG:-true}

# Directory Structure
MANIFESTS_DIR=${MANIFESTS_DIR:-manifests}
GENERATED_DIR=${GENERATED_DIR:-manifests/generated}
POST_INSTALL_DIR=${POST_INSTALL_DIR:-manifests/post-installation}
GENERATED_POST_INSTALL_DIR=${GENERATED_POST_INSTALL_DIR:-manifests/generated/post-install}
SSH_KEY=${SSH_KEY:-~/.ssh/id_rsa.pub}

# DPF Configuration
DPF_VERSION=${DPF_VERSION:-v25.10.1}
DPF_HELM_REPO_URL=${DPF_HELM_REPO_URL:-https://helm.ngc.nvidia.com/nvidia/doca/}
OVN_CHART_URL=${OVN_CHART_URL:-oci://ghcr.io/mellanox/charts}
OVN_TEMPLATE_CHART_URL=${OVN_TEMPLATE_CHART_URL:-oci://ghcr.io/mellanox/charts}
OVN_CHART_VERSION=${OVN_CHART_VERSION:-v25.7.1-cff70b1}
OVN_KUBERNETES_IMAGE_REPO=${OVN_KUBERNETES_IMAGE_REPO:-quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256}
OVN_KUBERNETES_IMAGE_TAG=${OVN_KUBERNETES_IMAGE_TAG:-de9b16e0bb85c3b5727d525012435516df345830661324cca4e8b1cbe4972e7a}
OVN_KUBERNETES_UTILS_IMAGE_REPO=${OVN_KUBERNETES_UTILS_IMAGE_REPO:-ghcr.io/mellanox/ovn-kubernetes-dpf-utils}
OVN_KUBERNETES_UTILS_IMAGE_TAG=${OVN_KUBERNETES_UTILS_IMAGE_TAG:-v25.7.1-cff70b1}
INJECTOR_RESOURCE_NAME=${INJECTOR_RESOURCE_NAME:-openshift.io/bf3-p0-vfs}

# GitOps Operator Configuration
GITOPS_OPERATOR_CHANNEL=${GITOPS_OPERATOR_CHANNEL:-1.16}
GITOPS_OPERATOR_VERSION=${GITOPS_OPERATOR_VERSION:-v1.16.4}

# Hypershift Configuration
HYPERSHIFT_IMAGE=${HYPERSHIFT_IMAGE:-quay.io/hypershift/hypershift-operator:latest}
HOSTED_CLUSTER_NAME=${HOSTED_CLUSTER_NAME:-doca}
CLUSTERS_NAMESPACE=${CLUSTERS_NAMESPACE:-clusters}
HOSTED_CONTROL_PLANE_NAMESPACE=${HOSTED_CONTROL_PLANE_NAMESPACE:-clusters-doca}
OCP_RELEASE_IMAGE=${OCP_RELEASE_IMAGE:-quay.io/openshift-release-dev/ocp-release:4.20.4-multi}
DISABLE_HCP_CAPS=${DISABLE_HCP_CAPS:-false}
DPF_CLUSTER_TYPE=${DPF_CLUSTER_TYPE:-hypershift}

# Network Configuration
POD_CIDR=${POD_CIDR:-10.128.0.0/14}
SERVICE_CIDR=${SERVICE_CIDR:-172.30.0.0/16}

# Pull Secrets
OPENSHIFT_PULL_SECRET=${OPENSHIFT_PULL_SECRET:-openshift_pull.json}
DPF_PULL_SECRET=${DPF_PULL_SECRET:-pull-secret.txt}

# VM Configuration
VM_PREFIX=${VM_PREFIX:-vm-dpf}
VM_COUNT=${VM_COUNT:-3}
RAM=${RAM:-41984}
VCPUS=${VCPUS:-14}
DISK_SIZE1=${DISK_SIZE1:-120}
DISK_SIZE2=${DISK_SIZE2:-80}
MAC_PREFIX=${MAC_PREFIX:-52:54:00:ee:42}

# Wait Configuration
MAX_RETRIES=${MAX_RETRIES:-90}
SLEEP_TIME=${SLEEP_TIME:-60}

# Paths
DISK_PATH=${DISK_PATH:-/var/lib/libvirt/images}
ISO_FOLDER=${ISO_FOLDER:-/var/lib/libvirt/images}
STATIC_NET_FILE=${STATIC_NET_FILE:-./configuration_templates/static_net.yaml}

# Storage
STORAGE_TYPE=${STORAGE_TYPE:-lvm}
BFB_STORAGE_CLASS=${BFB_STORAGE_CLASS:-lvms-vg1}


# Kubeconfig
KUBECONFIG=${KUBECONFIG:-./kubeconfig}

# CSR Approval
AUTO_APPROVE_WORKER_CSR=${AUTO_APPROVE_WORKER_CSR:-false}
AUTO_APPROVE_DPUCLUSTER_CSR=${AUTO_APPROVE_DPUCLUSTER_CSR:-false}
WORKER_COUNT=${WORKER_COUNT:-0}

# Verification
VERIFY_DEPLOYMENT=${VERIFY_DEPLOYMENT:-false}
VERIFY_MAX_RETRIES=${VERIFY_MAX_RETRIES:-60}
VERIFY_SLEEP_SECONDS=${VERIFY_SLEEP_SECONDS:-30}

# Traffic Flow Tests
TFT_REPO_REV=${TFT_REPO_REV:-main}
TFT_TEST_CASES=${TFT_TEST_CASES:-1-25}
TFT_DURATION=${TFT_DURATION:-10}
TFT_CONNECTION_TYPE=${TFT_CONNECTION_TYPE:-iperf-tcp}

# Sanity Tests
SANITY_TESTS_PODS_WORKLOAD_FILE=${SANITY_TESTS_PODS_WORKLOAD_FILE:-manifests/post-installation-manual/workload.yaml}
SANITY_TESTS_WORKLOAD_NAMESPACE=${SANITY_TESTS_WORKLOAD_NAMESPACE:-workload}
SANITY_TESTS_PING_COUNT=${SANITY_TESTS_PING_COUNT:-20}
SANITY_TESTS_PING_HBN_TO_HBN_PODS=${SANITY_TESTS_PING_HBN_TO_HBN_PODS:-false}
